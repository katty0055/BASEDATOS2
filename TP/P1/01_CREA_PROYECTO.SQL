CREATE TABLE P_CLIENTE
(	ID_CLIENTE           NUMBER(8) NOT NULL ,
	TIPO_CLIENTE         VARCHAR2(1) NOT NULL ,
	NOMBRE_CLIENTE       VARCHAR2(80) NULL ,
	APELLIDO_RAZON       VARCHAR2(80) NOT NULL ,
	CEDULA               VARCHAR2(11) NULL ,
	RUC                  VARCHAR2(15) NULL ,	
	DIRECCION_CLIENTE    VARCHAR2(70) NOT NULL ,
	TELEFONO_CLIENTE     VARCHAR2(15) NOT NULL ,
	CORREO               VARCHAR2(50) NOT NULL ,
	ID_LOCALIDAD         NUMBER(4) NOT NULL ,
CONSTRAINT  PK_CLIENTE PRIMARY KEY (ID_CLIENTE)
);


COMMENT ON TABLE P_CLIENTE IS 'Tabla de Clientes de la empresa';


COMMENT ON COLUMN P_CLIENTE.CEDULA IS 'Cedula del cliente';


COMMENT ON COLUMN P_CLIENTE.NOMBRE_CLIENTE IS 'Nombre del cliente';


COMMENT ON COLUMN P_CLIENTE.APELLIDO_RAZON IS 'Apellido del cliente o razon social';


COMMENT ON COLUMN P_CLIENTE.DIRECCION_CLIENTE IS 'Direccion del cliente';


COMMENT ON COLUMN P_CLIENTE.TELEFONO_CLIENTE IS 'Telefono del cliente';


COMMENT ON COLUMN P_CLIENTE.RUC IS 'Cedula + digito verificador';


COMMENT ON COLUMN P_CLIENTE.CORREO IS 'Direccion de correo electronico';


COMMENT ON COLUMN P_CLIENTE.ID_LOCALIDAD IS 'Idenfificacion de la localidad';


COMMENT ON COLUMN P_CLIENTE.ID_CLIENTE IS 'Identificación del cliente';


COMMENT ON COLUMN P_CLIENTE.TIPO_CLIENTE IS 'Indica si la persona es Física (F) o Jurídica(J)';

CREATE TABLE P_CONTRATO
(
	ID                   NUMBER(8) NOT NULL ,
	ID_PROYECTO          NUMBER(8) NOT NULL ,
	CONDICIONES          VARCHAR2(1000) NOT NULL ,
	GARANTIA             VARCHAR2(200) NOT NULL ,
	FECHA_CONTRATO       DATE NOT NULL ,
	FECHA_FIN            DATE NULL ,
	MOTIVO_FINALIZACION  NUMBER(2) NULL ,
	DIGITALIZADO         BLOB,
CONSTRAINT  PK_CONTRATO PRIMARY KEY (ID)
);



COMMENT ON TABLE P_CONTRATO IS 'Contrato entre el cliente y la empresa';


COMMENT ON COLUMN P_CONTRATO.ID IS 'Numero del  contrato';


COMMENT ON COLUMN P_CONTRATO.ID_PROYECTO IS 'Identificacion del proyecto';


COMMENT ON COLUMN P_CONTRATO.CONDICIONES IS 'Condiciones del Contrato';


COMMENT ON COLUMN P_CONTRATO.GARANTIA IS 'Descripcion de la garantia';


COMMENT ON COLUMN P_CONTRATO.FECHA_CONTRATO IS 'Fecha del contrato';


COMMENT ON COLUMN P_CONTRATO.FECHA_FIN IS 'Fecha real de finalizacion del contrato';


COMMENT ON COLUMN P_CONTRATO.MOTIVO_FINALIZACION IS 'Motivo de finalizacion';

COMMENT ON COLUMN P_CONTRATO.DIGITALIZADO IS 'Copia digitalizada del contrato';
CREATE TABLE P_CRONOGRAMA
(
	ID_ACTIVIDAD         NUMBER(8) NOT NULL ,
	ID_PROYECTO          NUMBER(8) NOT NULL ,
	DESCRIPCION_ACTIVIDAD VARCHAR2(100) NOT NULL ,
	FECHA_INICIO_PREVISTA DATE NOT NULL ,
	FECHA_FIN_PREVISTA   DATE NOT NULL ,
	ES_HITO              VARCHAR2(1) DEFAULT  'S'  NOT NULL ,
	FECHA_INICIO_REAL    DATE NULL ,
	FECHA_FIN_REAL       DATE NULL ,
	ACTIVIDAD_SUPERIOR   NUMBER(8) NULL ,
CONSTRAINT  PK_CRONOGRAMA_ACTIVIDADES PRIMARY KEY (ID_ACTIVIDAD)
);



COMMENT ON TABLE P_CRONOGRAMA IS 'Cronograma de Actividades';


COMMENT ON COLUMN P_CRONOGRAMA.ID_ACTIVIDAD IS 'Identificacion de la actividad';


COMMENT ON COLUMN P_CRONOGRAMA.ID_PROYECTO IS 'Identificacion del proyecto';


COMMENT ON COLUMN P_CRONOGRAMA.DESCRIPCION_ACTIVIDAD IS 'Descripcion de la actividad';


COMMENT ON COLUMN P_CRONOGRAMA.FECHA_INICIO_PREVISTA IS 'Fecha prevista para el  Inicio de la actividad';


COMMENT ON COLUMN P_CRONOGRAMA.FECHA_FIN_PREVISTA IS 'Fecha de finalización prevista';


COMMENT ON COLUMN P_CRONOGRAMA.ACTIVIDAD_SUPERIOR IS 'Actividad superior';


COMMENT ON COLUMN P_CRONOGRAMA.FECHA_INICIO_REAL IS 'Fecha real de inicio';


COMMENT ON COLUMN P_CRONOGRAMA.FECHA_FIN_REAL IS 'Fecha real de fin';


COMMENT ON COLUMN P_CRONOGRAMA.ES_HITO IS 'Indica si es o no hito (S/N)';

CREATE TABLE P_DEPARTAMENTO
(
	ID                   NUMBER(2) NOT NULL ,
	DESCRIPCION          VARCHAR2(50) NOT NULL ,
	ID_LOCALIDAD         NUMBER(4) NOT NULL ,
CONSTRAINT  PK_DEPARTAMENTO PRIMARY KEY (ID)
);




COMMENT ON COLUMN P_DEPARTAMENTO.ID IS 'Identificacion del departamento';




COMMENT ON COLUMN P_DEPARTAMENTO.DESCRIPCION IS 'Descripcion del departamento';




COMMENT ON COLUMN P_DEPARTAMENTO.ID_LOCALIDAD IS 'Identificador de la localidad';



CREATE TABLE P_FERIADOS
(
	FERIADO              DATE NOT NULL ,
	NOMBRE               VARCHAR2(100) NULL ,
CONSTRAINT  XPKP_FERIADOS PRIMARY KEY (FERIADO)
);



COMMENT ON TABLE P_FERIADOS IS 'Registro de feriados (excepto sábados y domingos)';




COMMENT ON COLUMN P_FERIADOS.FERIADO IS 'Fecha que será feriado';




COMMENT ON COLUMN P_FERIADOS.NOMBRE IS 'Nombre del feriado';



CREATE TABLE P_INVENTARIO
(
	ID_SUMINISTRO        NUMBER(8) NOT NULL ,
	ID_LOCALIDAD         NUMBER(4) NOT NULL ,
	STOCK_MINIMO         NUMBER(6) NOT NULL ,
	STOCK_MAXIMO         NUMBER(6) NOT NULL ,
	STOCK_ACTUAL         NUMBER(6) NOT NULL ,
CONSTRAINT  XPKP_INVENTARIO PRIMARY KEY (ID_SUMINISTRO,ID_LOCALIDAD)
);



COMMENT ON TABLE P_INVENTARIO IS 'Inventario de suministros por localidad ';




COMMENT ON COLUMN P_INVENTARIO.ID_SUMINISTRO IS 'Identificacion del suministro';




COMMENT ON COLUMN P_INVENTARIO.ID_LOCALIDAD IS 'Identificacion de la localidad';




COMMENT ON COLUMN P_INVENTARIO.STOCK_MINIMO IS 'Stock Minimo';




COMMENT ON COLUMN P_INVENTARIO.STOCK_MAXIMO IS 'Stock maximo';




COMMENT ON COLUMN P_INVENTARIO.STOCK_ACTUAL IS 'Stock actual';



CREATE TABLE P_LOCALIDAD
(
	ID                   NUMBER(4) NOT NULL ,
	DESCRIPCION          VARCHAR2(50) NOT NULL ,
CONSTRAINT  PK_LOCALIDAD PRIMARY KEY (ID)
);



COMMENT ON TABLE P_LOCALIDAD IS 'Localidades';




COMMENT ON COLUMN P_LOCALIDAD.ID IS 'Idenfificacion de la localidad';




COMMENT ON COLUMN P_LOCALIDAD.DESCRIPCION IS 'Descripcion de la localidad';



CREATE TABLE P_PERSONAL
(
	ID_PERSONAL          NUMBER(8) NOT NULL ,
	NOMBRE               VARCHAR2(50) NOT NULL ,
	APELLIDO             VARCHAR2(50) NOT NULL ,
	TELEFONO             VARCHAR2(20) NOT NULL ,
	DIRECCION            VARCHAR2(70) NOT NULL ,
	ID_DEPARTAMENTO      NUMBER(2) NOT NULL ,
	SALARIO              NUMBER(12,2) NOT NULL ,
	PERFIL               VARCHAR2(100) NOT NULL ,
	FECHA_INICIO         DATE NOT NULL ,
	PORC_BONIFICACION    NUMBER(4,2) NULL ,
	ID_SUPERIOR          NUMBER(8) NULL ,
	FOTO                 BFILE,
CONSTRAINT  PK_PERSONAL PRIMARY KEY (ID_PERSONAL)
);



COMMENT ON TABLE P_PERSONAL IS 'Tabla de funcionarios';




COMMENT ON COLUMN P_PERSONAL.ID_PERSONAL IS 'Identificación del funcionario';




COMMENT ON COLUMN P_PERSONAL.NOMBRE IS 'Nombre del funcionario';




COMMENT ON COLUMN P_PERSONAL.APELLIDO IS 'Apellido del funcionario';




COMMENT ON COLUMN P_PERSONAL.TELEFONO IS 'Telefono del funcionario';




COMMENT ON COLUMN P_PERSONAL.DIRECCION IS 'Dirección del funcionario';




COMMENT ON COLUMN P_PERSONAL.ID_SUPERIOR IS 'Identificación del superior inmediato';




COMMENT ON COLUMN P_PERSONAL.ID_DEPARTAMENTO IS 'Identificacion del area al que pertenece el recurso';




COMMENT ON COLUMN P_PERSONAL.SALARIO IS 'Salario basico mensual';




COMMENT ON COLUMN P_PERSONAL.FECHA_INICIO IS 'Fecha ingreso a la empresa';




COMMENT ON COLUMN P_PERSONAL.PORC_BONIFICACION IS 'Porcentaje de bonificación';




COMMENT ON COLUMN P_PERSONAL.PERFIL IS 'Descripción del perfil profesional';



COMMENT ON COLUMN P_PERSONAL.FOTO IS 'Foto del personal';

CREATE TABLE P_PERSONAL_ASIGNADO
(
	ID_ACTIVIDAD         NUMBER(8) NOT NULL ,
	ID_PERSONAL          NUMBER(8) NOT NULL ,
	HORAS_ASIGNADAS      NUMBER(5) NOT NULL ,
	ID_ROL               NUMBER(3) NULL ,
CONSTRAINT  XPKP_PERSONAL_ASIGNADO PRIMARY KEY (ID_ACTIVIDAD,ID_PERSONAL)
);



COMMENT ON TABLE P_PERSONAL_ASIGNADO IS 'Personal asignado para cada actividad';




COMMENT ON COLUMN P_PERSONAL_ASIGNADO.ID_ACTIVIDAD IS 'Identificacion de la actividad';




COMMENT ON COLUMN P_PERSONAL_ASIGNADO.ID_PERSONAL IS 'Identificacion del funcionario';




COMMENT ON COLUMN P_PERSONAL_ASIGNADO.HORAS_ASIGNADAS IS 'Total de horas asignadas para la actividad';




COMMENT ON COLUMN P_PERSONAL_ASIGNADO.ID_ROL IS 'Identificación del rol que cumple en dicha actividad';



CREATE TABLE P_PROYECTO
(
	ID_PROYECTO          NUMBER(8) NOT NULL ,
	NOMBRE_PROYECTO      VARCHAR2(200) NOT NULL ,
	OBJETIVO             VARCHAR2(500) NOT NULL ,
	DESCRIPCION          VARCHAR2(500) NOT NULL ,
	FECHA_PREVISTA_INICIO DATE NOT NULL ,
	DURACION_PREVISTA    NUMBER(4) NOT NULL ,
	DURACION_REAL        NUMBER(4) NULL ,
	ID_CLIENTE           NUMBER(8) NOT NULL ,
	COSTO_PREVISTO       NUMBER(12,2) NOT NULL ,
	COSTO_REAL           NUMBER(12,2) NULL ,
	FECHA_FIN_REAL       DATE NULL ,
	ESTADO               VARCHAR2(3) NOT NULL ,
CONSTRAINT  PK_PROYECTO PRIMARY KEY (ID_PROYECTO)
);



COMMENT ON TABLE P_PROYECTO IS 'Proyectos de la empresa con los clientes';




COMMENT ON COLUMN P_PROYECTO.ID_PROYECTO IS 'Identificacion del proyecto';




COMMENT ON COLUMN P_PROYECTO.OBJETIVO IS 'Objetivo del proyecto';




COMMENT ON COLUMN P_PROYECTO.DESCRIPCION IS 'Descripcion del proyecto';




COMMENT ON COLUMN P_PROYECTO.FECHA_PREVISTA_INICIO IS 'Fecha prevista de inicio de actividades del proyecto';




COMMENT ON COLUMN P_PROYECTO.DURACION_PREVISTA IS 'Duracion propuesta del proyecto en dias';




COMMENT ON COLUMN P_PROYECTO.DURACION_REAL IS 'Duracion real del proyecto en dias';




COMMENT ON COLUMN P_PROYECTO.ID_CLIENTE IS 'Identificacion del cliente';




COMMENT ON COLUMN P_PROYECTO.NOMBRE_PROYECTO IS 'Nombre por el que se conoce el proyecto';




COMMENT ON COLUMN P_PROYECTO.COSTO_REAL IS 'Costo real del proyecto';




COMMENT ON COLUMN P_PROYECTO.COSTO_PREVISTO IS 'Costo previsto del proyecto';




COMMENT ON COLUMN P_PROYECTO.FECHA_FIN_REAL IS 'Fecha de finalizacion real del proyecto';




COMMENT ON COLUMN P_PROYECTO.ESTADO IS 'Estado del proyecto que puede ser Planificado(PLA), En ejecucion (EJE), Finalizado (FIN), Cancelado (CAN).';



CREATE TABLE P_REGISTRO_HORAS
(
	ID_REGISTRO          NUMBER(12) NOT NULL ,
	ID_ACTIVIDAD         NUMBER(8) NULL ,
	ID_PERSONAL          NUMBER(8) NOT NULL ,
	FECHA_ACTIVIDAD      DATE NOT NULL ,
	HORAS_DEDICADAS      NUMBER(3) NOT NULL ,
	ACTIVIDAD_REALIZADA  VARCHAR2(100) NOT NULL ,
CONSTRAINT  XPKP_REGISTRO_HORAS PRIMARY KEY (ID_REGISTRO)
);



COMMENT ON TABLE P_REGISTRO_HORAS IS 'Registro de las actividades realizadas';




COMMENT ON COLUMN P_REGISTRO_HORAS.ID_REGISTRO IS 'Identificación del registro';




COMMENT ON COLUMN P_REGISTRO_HORAS.FECHA_ACTIVIDAD IS 'Fecha de actividad';




COMMENT ON COLUMN P_REGISTRO_HORAS.HORAS_DEDICADAS IS 'Horas dedicadas a la actividad';




COMMENT ON COLUMN P_REGISTRO_HORAS.ACTIVIDAD_REALIZADA IS 'Descripcion de la actividad realizada';




COMMENT ON COLUMN P_REGISTRO_HORAS.ID_ACTIVIDAD IS 'Identificacion de la actividad';




COMMENT ON COLUMN P_REGISTRO_HORAS.ID_PERSONAL IS 'Identificacion del funcionario';



CREATE TABLE P_ROL
(
	ID_ROL               NUMBER(3) NOT NULL ,
	NOMBRE_ROL           VARCHAR2(60) NOT NULL ,
	COSTOxHORA           NUMBER(6) NOT NULL ,
CONSTRAINT  XPKP_ROL PRIMARY KEY (ID_ROL)
);



COMMENT ON TABLE P_ROL IS 'Rol que puede desempeniar un personal en el proyecto';




COMMENT ON COLUMN P_ROL.ID_ROL IS 'Identificacion del rol';




COMMENT ON COLUMN P_ROL.NOMBRE_ROL IS 'Nombre del rol';




COMMENT ON COLUMN P_ROL.COSTOxHORA IS 'Costo por hora';



CREATE TABLE P_SUMINISTRO
(
	ID_SUMINISTRO        NUMBER(8) NOT NULL ,
	DESCRIPCION          VARCHAR2(50) NOT NULL ,
	COSTO                NUMBER(10,2) NOT NULL ,
	UNIDAD_MEDIDA        VARCHAR2(15) NOT NULL ,
CONSTRAINT  PK_SUMINISTRO PRIMARY KEY (ID_SUMINISTRO)
);



COMMENT ON TABLE P_SUMINISTRO IS 'Suministros que pueden ser utilizados en ell proyecto';




COMMENT ON COLUMN P_SUMINISTRO.ID_SUMINISTRO IS 'Identificacion del suministro';




COMMENT ON COLUMN P_SUMINISTRO.DESCRIPCION IS 'Descripcion del suministro';




COMMENT ON COLUMN P_SUMINISTRO.COSTO IS 'Costo del suministro';




COMMENT ON COLUMN P_SUMINISTRO.UNIDAD_MEDIDA IS 'Unidad de medida';



CREATE TABLE P_SUMINISTROS_ASIGNADOS
(	ID_ACTIVIDAD         NUMBER(8) NOT NULL ,
	ID_SUMINISTRO        NUMBER(8) NOT NULL ,
	CANTIDAD_REQUERIDA   NUMBER(6,2) NOT NULL ,
	FECHA_REQUERIDA      DATE NOT NULL ,
	CANTIDAD_UTILIZADA   NUMBER(6,2) NULL ,
	FECHA_REGISTRO       DATE NULL ,
CONSTRAINT  XPKP_SUMINISTROS_ASIGNADOS PRIMARY KEY (ID_ACTIVIDAD,ID_SUMINISTRO)
);



COMMENT ON TABLE P_SUMINISTROS_ASIGNADOS IS 'Suministros asignados al  proyecto';




COMMENT ON COLUMN P_SUMINISTROS_ASIGNADOS.ID_SUMINISTRO IS 'Identificacion del suministro';




COMMENT ON COLUMN P_SUMINISTROS_ASIGNADOS.CANTIDAD_REQUERIDA IS 'Cantidad requerida';




COMMENT ON COLUMN P_SUMINISTROS_ASIGNADOS.FECHA_REQUERIDA IS 'Fecha de utilizacion del suministro';




COMMENT ON COLUMN P_SUMINISTROS_ASIGNADOS.ID_ACTIVIDAD IS 'Identificacion de la actividad';




COMMENT ON COLUMN P_SUMINISTROS_ASIGNADOS.CANTIDAD_UTILIZADA IS 'Cantidad utilizada efectivamente en la actividad';




COMMENT ON COLUMN P_SUMINISTROS_ASIGNADOS.FECHA_REGISTRO IS 'Fecha registro de utilización de suministro';



ALTER TABLE P_CLIENTE
	ADD (CONSTRAINT FK_LOCALIDAD_CLIENTE FOREIGN KEY (ID_LOCALIDAD) REFERENCES P_LOCALIDAD (ID));



ALTER TABLE P_CONTRATO
	ADD (CONSTRAINT FK_PROYECTO_CONTRATO FOREIGN KEY (ID_PROYECTO) REFERENCES P_PROYECTO (ID_PROYECTO));



ALTER TABLE P_CRONOGRAMA
	ADD (CONSTRAINT FK_CRONOGRAMA_ACTIVIDAD FOREIGN KEY (ACTIVIDAD_SUPERIOR) REFERENCES P_CRONOGRAMA (ID_ACTIVIDAD));



ALTER TABLE P_CRONOGRAMA
	ADD (CONSTRAINT FK_PROYECTO_CRONOGRAMA FOREIGN KEY (ID_PROYECTO) REFERENCES P_PROYECTO (ID_PROYECTO));



ALTER TABLE P_DEPARTAMENTO
	ADD (CONSTRAINT FK_LOCALIDAD FOREIGN KEY (ID_LOCALIDAD) REFERENCES P_LOCALIDAD (ID));



ALTER TABLE P_INVENTARIO
	ADD (CONSTRAINT FK_LOCALIDAD_INVENTARIO FOREIGN KEY (ID_LOCALIDAD) REFERENCES P_LOCALIDAD (ID));



ALTER TABLE P_INVENTARIO
	ADD (CONSTRAINT FK_SUMINISTRO_INVENTARIO FOREIGN KEY (ID_SUMINISTRO) REFERENCES P_SUMINISTRO (ID_SUMINISTRO));



ALTER TABLE P_PERSONAL
	ADD (CONSTRAINT FK_PERSONAL_DEPARTAMENTO FOREIGN KEY (ID_DEPARTAMENTO) REFERENCES P_DEPARTAMENTO (ID));



ALTER TABLE P_PERSONAL_ASIGNADO
	ADD (CONSTRAINT FK_ACTIVIDAD_PERSONAL FOREIGN KEY (ID_ACTIVIDAD) REFERENCES P_CRONOGRAMA (ID_ACTIVIDAD));



ALTER TABLE P_PERSONAL_ASIGNADO
	ADD (CONSTRAINT FK_PERSONAL_ACTIVIDAD FOREIGN KEY (ID_PERSONAL) REFERENCES P_PERSONAL (ID_PERSONAL));



ALTER TABLE P_PERSONAL_ASIGNADO
	ADD (CONSTRAINT FK_ROL_ASIGNACION FOREIGN KEY (ID_ROL) REFERENCES P_ROL (ID_ROL));



ALTER TABLE P_PROYECTO
	ADD (CONSTRAINT FK_CLIENTE_PROYECTO FOREIGN KEY (ID_CLIENTE) REFERENCES P_CLIENTE (ID_CLIENTE));



ALTER TABLE P_REGISTRO_HORAS
	ADD (CONSTRAINT FK_PERSONAL_REGISTRO FOREIGN KEY (ID_ACTIVIDAD, ID_PERSONAL) REFERENCES P_PERSONAL_ASIGNADO (ID_ACTIVIDAD, ID_PERSONAL));



ALTER TABLE P_SUMINISTROS_ASIGNADOS
	ADD (CONSTRAINT FK_SUMINISTRO_PROYECTO FOREIGN KEY (ID_SUMINISTRO) REFERENCES P_SUMINISTRO (ID_SUMINISTRO));



ALTER TABLE P_SUMINISTROS_ASIGNADOS
	ADD (CONSTRAINT FK_ACTIVIDAD_SUMINISTRO FOREIGN KEY (ID_ACTIVIDAD) REFERENCES P_CRONOGRAMA (ID_ACTIVIDAD));


